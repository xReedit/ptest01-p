<dom-module id="x-pass"><link rel="import"href="../../x-componentes/x-comp-btn-permiso/x-comp-btn-permiso.html"><template><paper-dialog id="dialog_cotent"entry-animation="scale-up-animation"exit-animation="fade-out-animation"with-backdrop><div><h3 id="titulo">{{titulo}}</h3><div style="text-align:left"><p class="xRojo"id="msj_passUs"></p><br><div hidden$="[[!permisoremoto]]"><x-comp-btn-permiso></x-comp-btn-permiso></div><paper-input id="us"label="Usuario"autofocus autocomplete="off"></paper-input><paper-input id="pass"type="password"label="Clave"></paper-input><br><button tabindex="0"class="btn btn-success"onclick="xVerificarPassUs()">Listo</button> <button tabindex="0"class="btn btn-dark"onclick="xCerrar()">Cancelar</button></div></div></paper-dialog></template></dom-module><style>.xRojo{color:red}paper-button[raised].xverde{background:#cee0cf;color:#fff;text-align:center}paper-button[raised].xnegro{background:#424242;color:#fff}#dialog_cotent{border-radius:5px;text-align:center;padding:8px;border:1px solid #bdbdbd}</style><script>var xThisPass,xRpts,xpass_d;function xIiniPass(){$("#us").focus(),$("#us").on("keyup",function(s){s=s.which;13!=s&&186!=s||pass.$.input.focus()}),$("#pass").on("keyup",function(s){var o=s.which;13!=o&&186!=o||xVerificarPassUs(),s.stopPropagation(),s.stopImmediatePropagation()}),$("#dialog_cotent").on("iron-overlay-opened",function(){$("#us").focus()})}function xVerificarPassUs(){xRpts=new Array;var o,s=$("#us").val(),a=$("#pass").val(),e=xThisPass.valor;$("#msj_passUs").text(""),$.ajax({type:"POST",url:"../../bdphp/log.php?op=-102",data:{u:s,p:a}}).done(function(s){s=$.parseJSON(s);0<s.datos.length?-1==s.datos[0].per.indexOf(e)?o=0:(o=1,xRpts.push({us:s.datos[0].idusuario,p:o,nomus:$("#us").val()}),"Pe5"===e?xThisPass.fire("xSendPe5",{xRpts:xRpts}):xThisPass.fire("xSend",{xRpts:xRpts}),$("#us").val(""),$("#pass").val(""),xpass_d.close()):o=2,xVerRpt(o)})}function xVerRpt(s){var o="";switch(s){case 0:o="El usuario no tiene permiso";break;case 2:o="Usuario o clave incorrecto"}$("#msj_passUs").text(o)}function xCerrar(){xpass_d.close()}Polymer({is:"x-pass",properties:{titulo:{type:String,value:""},valor:{type:String,value:""},permisoremoto:Boolean},attached:function(){xThisPass=this,(xpass_d=document.getElementById("dialog_cotent")).close(),xIiniPass()},open:function(s){xpass_d.open()},setVal:function(s){valBus=s;try{xThisPass.valor=s}catch(s){}},xopen:function(){xpass_d.open()},xclose:function(){xpass_d.close()},solicitarPermisoRemoto:s=>{xThisPass.permisoremoto=s}})</script>