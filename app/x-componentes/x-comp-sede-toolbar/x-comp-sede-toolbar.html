<link rel="import"href="../../web_components/polymer/polymer.html"><dom-module id="x-comp-sede-toolbar"><template><paper-dialog id="dialog_sede"class="dialog_redondo xFondoRowPlomo4"style="min-width:350px"entry-animation="scale-up-animation"exit-animation="fade-out-animation"><div class=""><h4>Seleccione Sede de trabajo:</h4><hr><div><table width="100%"class="xtable5"><tbody><template is="dom-repeat"items="{{listSede}}"as="item"><tr data-id="{{index}}"class="xCursor"onclick="xCompSedeToll_CambiarSede(this)"><td>{{item.nombre}}<td>{{item.ciudad}}</template></table></div><br></div></paper-dialog><div><span class=""title="Cambiar Sede"onclick="xCompSedeToll_MostarSeleccionSede()"id="txt_sede">RESTOBAR</span></div></template><script>var xThisComToolSede,_opSelectSede=!1;function xCompSedeToll_MostarSeleccionSede(){_opSelectSede&&dialog_sede.open()}async function xCompSedeToll_CambiarSede(e){e=e.dataId;const o=xThisComToolSede.listSede[e];$.ajax({type:"POST",url:"../../bdphp/log.php?op=-1001",data:{i:o.idsede}}).done(e=>{xm_LogIni(e=>{updateapp3_woDUS_changeSede(o.idorg,o.idsede),localStorage.setItem("::app3_woUsS",o.idsede),localStorage.removeItem("::app3_sys_descat"),xThisComToolSede.objSedeSelectedToolBar=o,status_SetUsChangeSede(!0),$("body").removeClass("loaded"),setTimeout(()=>{$("#txt_sede").text(o.nombre+" | "+o.ciudad),dialog_sede.close(),$("body").addClass("loaded")},500)})})}function xChangeNameSedeToolBar(){$("#txt_sede").text(xThisComToolSede.objSedeSelectedToolBar.nombre+" | "+xThisComToolSede.objSedeSelectedToolBar.ciudad)}function xCompSedeToll_getAllSedes(){var e=xm_log_get("app3_us");const o=localStorage.getItem("::app3_woUsS")?localStorage.getItem("::app3_woUsS"):e?e.idsede:null,d=e?e.rol:null;$.ajax({type:"POST",url:"../../bdphp/log_componentes.php?op=1"}).done(function(e){e=$.parseJSON(e),xThisComToolSede.listSede=e.datos,xThisComToolSede.sedes=xThisComToolSede.listSede[0],xThisComToolSede.getValorIncial(xThisComToolSede.sedes),_opSelectSede=1<e.datos.length,null===o?$.ajax({url:"../../bdphp/log.php?op=-1002"}).done(e=>{xCompSedeToll_buscarSede((e=e.split(","))[0]),xCompSedeToll_rol(e[1])}):(xCompSedeToll_buscarSede(o),xCompSedeToll_rol(d))})}function xCompSedeToll_rol(e){var o="";_opSelectSede=!1,1===parseInt(e)&&1<xThisComToolSede.listSede.length&&(o="Click para cambiar sede",$("#txt_sede").addClass("clickSelToolSede xCursor"),_opSelectSede=!0),$("#txt_sede").attr("title",o)}function xCompSedeToll_buscarSede(o){var e=xThisComToolSede.listSede.filter(e=>e.idsede===o).map(e=>e)[0];$("#txt_sede").text(e.nombre+" | "+e.ciudad)}Polymer({is:"x-comp-sede-toolbar",properties:{listSede:[],sedes:{type:Object,reflectToAttribute:!0,notify:!0,value:function(){return{}},observer:"sedeNameChanged"},objSedeSelectedToolBar:[]},listeners:{onchange:"getSede"},sedeNameChanged:function(e){return e},getSede(){return this.sedes},attached:function(){xThisComToolSede=this},init:()=>{xCompSedeToll_getAllSedes()},getValorIncial:function(e){this.fire("getValorIncial",{sedes:e})}})</script></dom-module>