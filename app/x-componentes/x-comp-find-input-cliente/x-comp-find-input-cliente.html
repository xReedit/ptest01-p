<link rel="import" href="../../web_components/polymer/polymer.html">
<link rel="import" href="../../web_components/paper-input-autocomplete/paper-input-autocomplete.html">
<dom-module id="x-comp-find-input-cliente">
<template>
<paper-input-autocomplete id="input_clie_nombres_auto" label="{{label}}" value="{{inputValue}}" search-property="nombres" onkeyup="searchClienteInput(this)" on-autocomplete-selected="xchangeCliente" autocomplete-search-length="2" disable-show-clear="true"></paper-input-autocomplete>
<p hidden$="[[!isErrorLength]]" class="fs-13 text-danger">MÃ­nimo 5 caracteres.</p>
</template>
</dom-module>
<script>/*<![CDATA[*/var xThisComInputCliente,_autocompleteComp;function getAllClientesInit(){getAllClientes();}
function getAllClientes(val_input=''){if(val_input.length<3){return;}
$.ajax({type:'POST',url:'../../bdphp/log_componentes.php?op=70101',data:{val:val_input}}).done(function(DtProv){var xDtProv=JSON.parse(DtProv);xThisComInputCliente.list_cliente=xDtProv.datos;const listElementInput=input_clie_nombres_auto;if(listElementInput.length){for(let item of listElementInput){item.source=xDtProv.datos;}}else{listElementInput.source=xDtProv.datos;}});}
function resetSource(){input_clie_nombres_auto.source=xThisComInputCliente.list_cliente}
function searchClienteInput(){if(event.keyCode==13){return;}
const valInput=event.target.value;compRemoveSpecialCharObjClient(event);if(valInput.length<3){return;}
getAllClientes(valInput);}
function compRemoveSpecialCharObjClient(e){e.target.value=e.target.value.replace(/[&\/\\,~'"?]/g,'');xThisComInputCliente.isErrorLength=e.target.value.length>0&&e.target.value.length<5;xThisComInputCliente.xchangeCliente();}
Polymer({is:'x-comp-find-input-cliente',properties:{_autocompleteComp:Object,label:String,inputValue:{type:String,notify:true},cliente:{},list_cliente:{type:Object,reflectToAttribute:true,notify:true,value:function(){return{};},observer:'clienteNameChanged'},valIdInt:{type:Object,notify:true,reflectToAttribute:true},isErrorLength:Boolean},listeners:{'onchange':'getCliente'},clienteNameChanged:function(){return this.list_cliente;},getCliente(e){return e;},attached:function(){this.isErrorLength=false;xThisComInputCliente=this;getAllClientesInit();},reloadllClientes:function(){getAllClientes();},xchangeCliente:()=>{const cliente=event.target.value;event.target.fire('input-autocomplete-selected',cliente);}})/*]]>*/</script>