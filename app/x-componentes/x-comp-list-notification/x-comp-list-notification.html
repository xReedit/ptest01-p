<dom-module id="x-comp-list-notification"><template is="dom"><paper-dialog id="dialog_notificaciones"class="dialog_redondo position-list-notification animate__animated animate__fadeIn animate__faster"><div><p class="fw-600">Notificaciones<div class="xLinea2"></div><br><table width="100%"><template is="dom-repeat"items="{{lisNotificaciones}}"as="item"><tr><td class="xCursor"data-id="[[ index ]]"onclick="goPageListNotification(this)"><p>{{ item.descripcion }} <i class$="{{ item.icon }}"></i></p><span class="text-secondary fs-12">{{ item.detalle }}</span></template></table><div></div></div><br></paper-dialog></template></dom-module><style>.position-list-notification{position:relative;float:right;margin-top:65px;margin-right:15px;max-width:400px!important}</style><script>var xThisListNotificacion,resCountNotification,isShowAlertNotification=!1,listAddNotification=[];function xIniCompListNotificacion(i){$.ajax({type:"POST",url:"../../bdphp/log_componentes.php?op=13",async:!1}).done(function(i){resCountNotification=JSON.parse(i).datos[0],verifyShowNotification()})}function createListNotifications(){var i,o={},t="",e=0;xThisListNotificacion.lisNotificaciones=[],listAddNotification=[],0<resCountNotification.stock_minimo&&(t=1<resCountNotification.stock_minimo?"s":"",o={key:"stock_minimo",fecha:"",descripcion:"Stock Mínimo",detalle:resCountNotification.stock_minimo+`\r Producto${t}\r con stock mínimo.`,idpage:17,parametro:"?stock_minimo=si",icon:"fa fa-minus-square text-danger"},listAddNotification.push(o),e++),0<resCountNotification.cumple_clientes&&(i=1<resCountNotification.cumple_clientes?"n":"",t=1<resCountNotification.cumple_clientes?"s":"",o={key:"cumple_clientes",fecha:"",descripcion:"Cumpleaños de Clientes",detalle:resCountNotification.cumple_clientes+`\r  Cliente${t}\r cumplira${i}\r años en los próximos dias, enviale${t}\r una invitación, descuento o promoción.`,idpage:35,parametro:"?cumple=si",icon:"fa fa-smile-o text-success fw-600"},listAddNotification.push(o),e++),0<resCountNotification.comprobantes_no_enviados&&(t=1<resCountNotification.comprobantes_no_enviados?"s":"",o={key:"comprobantes_no_enviados",fecha:"",descripcion:"Comprobantes Electrónicos",detalle:resCountNotification.comprobantes_no_enviados+`\r Comprobante${t}\r electronico${t}\r no enviado${t}.`,idpage:26,parametro:"",icon:"fa fa-sticky-note-o text-info"},listAddNotification.push(o),e++),0<resCountNotification.calificaciones_clientes&&(i=1<resCountNotification.calificaciones_clientes?"aron":"ó",t=1<resCountNotification.calificaciones_clientes?"s":"",o={key:"calificaciones_clientes",fecha:"",descripcion:"Calificaciones Negativas",detalle:resCountNotification.calificaciones_clientes+`\r Cliente${t}\r calific${i}\r su experiencia de forma negativa.`,idpage:41,parametro:"",icon:"fa fa-star text-danger"},listAddNotification.push(o),e++),""!==resCountNotification.cpe_alert&&(o={key:"msj_cpe_alert",fecha:"",descripcion:"Alerta de facturación electrónica",detalle:""+resCountNotification.cpe_alert,idpage:0,parametro:"",icon:"fa fa-exclamation-circle text-danger"},listAddNotification.push(o),e++),xThisListNotificacion.lisNotificaciones=JSON.parse(JSON.stringify(listAddNotification)),$(divIconNotification).removeClass("xInvisible"),$(divIconNotification).find(".xbell-count").text(e)}function verifyShowNotification(){(isShowAlertNotification=0<parseFloat(resCountNotification.suma))&&(isShowNotification(),createListNotifications())}function isShowNotification(){xThisListNotificacion.fire("xShowNotifications",{isShowAlertNotification:isShowAlertNotification});var i=document.getElementById("alertaNotificaciones");i.autobuffer=!0,i.muted=!1,setTimeout(()=>{i.load(),i.play(),setTimeout(()=>{i.load(),i.play()},1e3)},1500)}function goPageListNotification(i){i=i.dataId,i=xThisListNotificacion.lisNotificaciones[i];setLocalSotrage("::app3_sys_route",0),xOpenPage(i.idpage,i.parametro),dialog_notificaciones.close(),41===i.idpage&&updateCheckCalificacion()}function updateCheckCalificacion(){$.ajax({type:"POST",url:"../../bdphp/log_componentes.php?op=1301"}).done(function(i){console.log(i)})}Polymer({is:"x-comp-list-notification",properties:{lisNotificaciones:[]},xopen(){dialog_notificaciones.open()},ready:function(){this.lisNotificaciones=[],xThisListNotificacion=this,xIniCompListNotificacion()}})</script>