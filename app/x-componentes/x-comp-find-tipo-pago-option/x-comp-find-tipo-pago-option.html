<link rel="import"href="../../web_components/polymer/polymer.html"><dom-module id="x-comp-find-tipo-pago-option"><template is="dom-bind"><div style="display:flex"><div class="content_div_op_pago selected-template-1"id="_content_div_op_pago"style="display:grid;max-width:450px;grid-template-columns:repeat(6,auto);grid-auto-flow:row;grid-gap:10px"disabled$="{{deshabilitado}}"><template is="dom-repeat"items="{{listOptionPago}}"as="categoria"><div class="xMiBoton_icon_option"style="margin-right:0"data-id="{{categoria.idtipo_pago}}"data-index="{{index}}"data-reqcliente="{{categoria.requiere_cliente}}"data-limite="{{categoria.limite}}"data-descripcion="{{categoria.descripcion}}"selected$="{{categoria.seleccionado}}"hidden$="{{categoria.hidden}}"onclick="selectOption(this)"><img src="{{categoria.logo}}"><p>{{categoria.descripcion}}</div></template></div></div></template><script>var xThisComTipoPagoOption,_ispagoappop=!1;function getAllTipoPagoOption(){xThisComTipoPagoOption.listOptionPago=[],_ispagoappop=xThisComTipoPagoOption.ispagoappop||!1;var o=localStorage.getItem("::app3_comp_tpp_all");(o=o?JSON.parse(o):null)?cocinanarDataTppALL(o):$.ajax({type:"GET",url:"../../bdphp/log_componentes.php?op=602"}).done(function(o){o=(o=JSON.parse(o)).datos,localStorage.setItem("::app3_comp_tpp_all",JSON.stringify(o)),cocinanarDataTppALL(o)})}function cocinanarDataTppALL(o){let t=!1,p=0,i,a=xm_log_get("datos_org_sede")[0]?.metodo_pago_aceptados||null;a=a&&(""===a?null:a),xThisComTipoPagoOption.listOptionPago=[],_ispagoappop=xThisComTipoPagoOption.ispagoappop||!1;o=o.filter(o=>_ispagoappop?"4"===o.idtipo_pago.toString():"4"!==o.idtipo_pago.toString());i=(i=o.map((o,i)=>{if(a){if(a.indexOf(o.idtipo_pago)<0)return o.visible=!1,o}else if("1"==o.visible)return o.visible=!1,o;return o.logo="../../images/"+o.img,o.descripcion=xMayusculaPrimera(o.descripcion.toLowerCase()),o.hidden=-1<xThisComTipoPagoOption.novisibles.indexOf(o.idtipo_pago),o.hidden||t?o.seleccionado=!1:(t=!0,o.seleccionado=!0,p=i),o.visible=!0,o})).filter(o=>o.visible),xThisComTipoPagoOption.listOptionPago=JSON.parse(JSON.stringify(i)),xThisComTipoPagoOption.list_tipo_pago=xThisComTipoPagoOption.listOptionPago[p],xThisComTipoPagoOption.list_tipo_pago.index=p,xThisComTipoPagoOption.idselect=xThisComTipoPagoOption.list_tipo_pago.idtipo_pago,xThisComTipoPagoOption.reqcliente=xThisComTipoPagoOption.list_tipo_pago.requiere_cliente,xThisComTipoPagoOption.limite=xThisComTipoPagoOption.list_tipo_pago.limite,xThisComTipoPagoOption.valIdInt=xThisComTipoPagoOption.list_tipo_pago,xThisComTipoPagoOption.getValorIncial(xThisComTipoPagoOption.list_tipo_pago)}function selectOption(o){const t=o.dataIndex;var i=o.dataId;xThisComTipoPagoOption.idselect=i,xThisComTipoPagoOption.reqcliente=xThisComTipoPagoOption.listOptionPago[t].requiere_cliente,xThisComTipoPagoOption.limite=xThisComTipoPagoOption.listOptionPago[t].limite,$(o).parent().find(".xMiBoton_icon_option").each((o,i)=>{i.dataIndex===t?$(i).attr("selected",!0):$(i).removeAttr("selected")}),xSelectViewOption(t)}function xSelectViewOption(o){xThisComTipoPagoOption.listOptionPago.map(o=>(o.seleccionado="",o)),xThisComTipoPagoOption.listOptionPago[o].seleccionado=!0,xThisComTipoPagoOption.list_tipo_pago=xThisComTipoPagoOption.listOptionPago[o],xThisComTipoPagoOption.getValorIncial(xThisComTipoPagoOption.list_tipo_pago)}Polymer({is:"x-comp-find-tipo-pago-option",properties:{novisibles:{type:String,value:""},ispagoappop:Boolean,deshabilitado:{type:Boolean,value:!1},hiddenIconBorrar:{type:Boolean,value:!0},idselect:{type:Number,value:1},reqcliente:{type:Number,value:0},limite:{type:Number,value:1},listOptionPago:{type:Object,reflectToAttribute:!0,notify:!0},list_tipo_pago:[],valIdInt:{type:Object,notify:!0,reflectToAttribute:!0}},listeners:{onchange:"getTipoPagoOption",onclick:"getTipoPagoOption"},setResetOption:()=>{getAllTipoPagoOption()},tipoPagoNameChanged:function(o){return o},getTipoPagoOption(){return this.listOptionPago.filter(o=>o.seleccionado)[0]},attached:function(){(xThisComTipoPagoOption=this).listOptionPago=[],getAllTipoPagoOption()},getValorIncial:function(o){this.fire("getValorIncial",{values:o})},setResetFirstOption:()=>{xThisComTipoPagoOption.listOptionPago&&0!==xThisComTipoPagoOption.listOptionPago.length&&(xThisComTipoPagoOption.listOptionPago.map(o=>{o.seleccionado=""}),xThisComTipoPagoOption.listOptionPago[0].seleccionado=!0,$("#_content_div_op_pago div.xMiBoton_icon_option").each((o,i)=>{0===i.dataIndex?$(i).attr("selected",!0):$(i).removeAttr("selected")}))},detached:function(){xThisComTipoPagoOption.listOptionPago=[]}})</script></dom-module>