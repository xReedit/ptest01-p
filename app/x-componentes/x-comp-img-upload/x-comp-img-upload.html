<dom-module id="x-comp-img-upload"><link rel="stylesheet"href="../../../css/croppie.css"><script src="../../../js/croppie.js"></script><template><div class="pb-2"hidden$="[[isShowResult]]"><a class="btn btn-sm btn-info file-btn"><span>Cargar Imagen</span> <input type="file"id="upload"value="Choose a file"accept="image/*"> </a><button class="btn btn-sm btn-success upload-result">Establecer</button></div><div class="upload-demo-wrap"hidden$="[[isShowResult]]"><div class="upload-demo"></div></div><div hidden$="[[!isShowResult]]"class="animate__animated animate__fadeIn"><button class="btn btn-sm btn-secondary mb-2"onclick="xEditarComImg()">Editar</button><div id="result"></div></div></template></dom-module><style>.file-btn{position:relative}.file-btn input[type=file]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0}.upload-demo .upload-demo-wrap,.upload-demo .upload-result,.upload-demo.ready .upload-msg{display:none}.upload-demo.ready .upload-demo-wrap{display:block}.upload-demo.ready .upload-result{display:inline-block}.upload-demo-wrap{width:350px;height:300px;margin:0 auto}#result img{border:2px solid #9e9e9e;border-radius:5px}</style><script>var xThisCompImg,optsImg,imgCompImgBase64,$uploadCrop;function xComIniUpLoadImg(){optsImg={url:"../../file/promo_demo.JPG",viewport:{width:xThisCompImg.medidasimg.width,height:xThisCompImg.medidasimg.height}},demoUpload(),resetMedidas()}function resetMedidas(o){xThisCompImg.medidascontent?($(".upload-demo-wrap").width(xThisCompImg.medidascontent.width+50),$(".upload-demo-wrap").height(xThisCompImg.medidascontent.height+50)):($(".upload-demo-wrap").width(xThisCompImg.medidasimg.width+50),$(".upload-demo-wrap").height(xThisCompImg.medidasimg.height+50)),$uploadCrop.croppie("bind",optsImg)}function resetControlImg(){$uploadCrop.croppie("bind",optsImg)}function demoUpload(){$(".upload-demo").data("croppie")||($uploadCrop=$(".upload-demo").croppie(optsImg)),$("#upload").on("change",function(){var o,i;(o=this).files&&o.files[0]&&((i=new FileReader).onload=function(o){$(".upload-demo").addClass("ready"),$uploadCrop.croppie("bind",{url:o.target.result}).then(function(){})},i.readAsDataURL(o.files[0]))}),$(".upload-result").on("click",function(o){$uploadCrop.croppie("result",{type:"canvas",size:"viewport"}).then(function(o){popupResult({src:o})})})}function popupResult(o){var i;o.html&&(i=o.html),o.src&&(imgCompImgBase64=o.src,i='<img src="'+o.src+'" />'),$("#result").html(i),xThisCompImg.isShowResult=!0,xThisCompImg.isEstablecioImg=!0,xThisCompImg.isUploadImg=!0}function xEditarComImg(){xThisCompImg.isShowResult=!1}function setImagenFile(o){xThisCompImg.isShowResult=!0,xThisCompImg.isEstablecioImg=!0,xThisCompImg.isUploadImg=!1;o='<img src="'+o+'" />';$("#result").html(o)}Polymer({is:"x-comp-img-upload",properties:{isShowResult:Boolean,medidasimg:[],medidascontent:[],isEstablecioImg:Boolean,isUploadImg:Boolean},attached:function(){this.isShowResult=!1,this.isEstablecioImg=!1,this.isUploadImg=!1,xThisCompImg=this,xComIniUpLoadImg()},getImgBase64:()=>imgCompImgBase64,getIsEstablecioImg:()=>xThisCompImg.isEstablecioImg,getIsUploadImg:()=>xThisCompImg.isUploadImg,setImgPathFile:o=>{setImagenFile(o)},resetControl:()=>{xThisCompImg.isShowResult=!1,xThisCompImg.isEstablecioImg=!1,xThisCompImg.isUploadImg=!1,resetControlImg()},setMedidas:o=>{this.$.medidasimg=o,resetMedidas()}})</script>