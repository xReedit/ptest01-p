<dom-module id="x-comp-pago-tarjeta"><template is="dom"><paper-dialog id="dialog_pago_servicio_tarjeta"style="min-width:310px;max-width:400px"class="dialog_redondo animate__animated animate__fadeIn animate__faster"modal="true"entry-animation="scale-up-animation"exit-animation="fade-out-animation"modal><div style="float:right;margin-top:0;margin-right:-20px"><button class="btn btn-sm btn-secondary"dialog-dismiss>X</button></div><div class="text-center"><p class="fw-600 text-secondary">Importe a Pagar</p><br><div class="xLinea2"></div><br><p class="fw-600 fs-30">S/. {{ importepagar }}</p><br><div class="xLinea2"></div><br><div class="text-left"hidden$="[[showConfirmOperacion]]"id="div_tipo_pago"><p class="fs-15 fw-600 text-secondary">Selecciona la forma de pago:<p class="fw-600">Abono en cuenta</p><template is="dom-repeat"items="{{listCuentaAbonoServicio}}"as="item"><div data-id="[[ item.idcuenta_papaya ]]"style="display:flex;flex-direction:row;align-items:center"class="p-1 border-bottom xCursor"onclick="bancoSelected(this)"><div class="pr-2"><img src="../../images/{{item.logo_banco}}"alt=""></div><div class="pl-2 text-left"><p class="fw-600">{{ item.banco }}<p>{{ item.numero }}</div></div></template><div hidden$="[[ !isshowpagotarjeta ]]"><br><p class="fw-600">Pago con cualquier tarjeta<p class="text-secondary fs-11">Visa, Mastercard, Diners, Amex, etc...<div class="text-center"><br><div hidden="[[showProcessT]]"><paper-spinner active id="loader_btn_pago"></paper-spinner><div id="btn_pago"></div><a href="http://papaya.com.pe/terminos-condiciones.html"target="_blank">Terminos y condiciones</a></div><div hidden$="[[!showProcessT]]"><paper-spinner active></paper-spinner></div></div><br></div></div><div class="text-center xInvisible"id="div_res_tarjeta"><div id="div_t_error"><p class="fw-600 text-danger fs-15">Ocurrio un error</p><br><p class="fw-600 text-danger fs-15">{{ msjT }}</p><br><p>Intentelo nuevamente.</p><br><button class="btn btn-secondary"dialog-dismiss onclick="location.reload()">Cerrar</button></div><div id="div_t_success"><p class="fw-600 text-success fs-15">Transaccion Exitosa</p><br><p>{{ msjT }}</p><br><p>Muchas grcias. Podrá descargar la factura del servicio luego de la confirmación.</p><br><button class="btn btn-secondary"dialog-dismiss>Cerrar</button></div><br><br></div><div class="text-center"hidden$="[[!showConfirmOperacion]]"><p>Ingresa el número de operacion bancaria (deposito)</p><input class="xMiInput xPasarEnter2 text-center"placeholder="# Operacion"id="text_noperacion"espaciar> <input class="xMiInput text-center"placeholder="Comentario"id="text_comentario"><br><div class="xLinea2"></div><br><br><div hidden$="[[showConfirmOperacionMsj]]"><button class="btn btn-success"onclick="enviarParaValidar()">Enviar para validar</button></div><div hidden$="[[!showConfirmOperacionMsj]]"><p class="fw-600 text-info">Muchas gracias. La confirmación del pago se realizara en breve.</div><br></div></div><br></paper-dialog></template><script src="../../../js/boton-pago.js"></script></dom-module><script>var xThisCompPagoTajeta,xDataClientePagoTarjeta,xidBancoSelected;function xIniCompPagoTarjeta(a){xThisCompPagoTajeta.showConfirmOperacion=!1,xThisCompPagoTajeta.showConfirmOperacionMsj=!1,xThisCompPagoTajeta.showProcessT=!1,xPopupLoad=document.getElementById("xLoad")}function callPurchaseNumber(o){xThisCompPagoTajeta.showConfirmOperacion=!1,xThisCompPagoTajeta.isshowpagotarjeta=0<o,xThisCompPagoTajeta.importepagar=o,xloadCuentasAbonoServicio(),xThisCompPagoTajeta.isshowpagotarjeta?(xPopupLoad.xopen(),$.ajax({type:"POST",url:"../../bdphp/log_005.php?op=5003"}).done(function(a){a=JSON.parse(a).datos[0];xDataClientePagoTarjeta=a,$.ajax({type:"GET",url:"https://api.ipify.org?format=json"}).done(a=>{xDataClientePagoTarjeta.ip=a.ip,$.ajax({type:"POST",url:"../../bdphp/log_005.php?op=5002"}).done(a=>{a=JSON.parse(a).datos[0].purchasenumber;xDataClientePagoTarjeta.nombre="",xDataClientePagoTarjeta.apellido="",pagar(o,a,xDataClientePagoTarjeta),xPopupLoad.xclose(),dialog_pago_servicio_tarjeta.open()})})})):dialog_pago_servicio_tarjeta.open()}function xloadCuentasAbonoServicio(){$.ajax({type:"POST",url:"../../bdphp/log_005.php?op=5004"}).done(function(a){xThisCompPagoTajeta.listCuentaAbonoServicio=JSON.parse(a).datos})}function bancoSelected(a){xThisCompPagoTajeta.showConfirmOperacion=!0,xidBancoSelected=a.dataId}function enviarParaValidar(){var a={idcuenta_papaya:xidBancoSelected,noperacion:text_noperacion.value,comentario:text_comentario.value};xThisCompPagoTajeta.fire("onSuccessA",a),setTimeout(()=>{xThisCompPagoTajeta.showConfirmOperacionMsj=!0},1e3)}function loaderTransaction(a){xThisCompPagoTajeta.showProcessT=a}function loaderTransactionResponseOut(a,o){$(div_res_tarjeta).removeClass("xInvisible"),$(div_tipo_pago).addClass("xInvisible"),(xThisCompPagoTajeta.showSuccessT=o)?($(div_t_error).removeClass("xInvisible"),$(div_t_success).addClass("xInvisible")):($(div_t_success).removeClass("xInvisible"),$(div_t_error).addClass("xInvisible"),xThisCompPagoTajeta.fire("onSuccessT")),xThisCompPagoTajeta.msjT=a?.data?.ACTION_DESCRIPTION}Polymer({is:"x-comp-pago-tarjeta",properties:{importepagar:Number,isshowpagotarjeta:Boolean,listCuentaAbonoServicio:[],showConfirmOperacion:Boolean,showConfirmOperacionMsj:Boolean,showSuccessT:Boolean,showProcessT:Boolean,msjT:String},attached:function(){this.numcountsucces=5,this.showSuccessT=!1,this.showProcessT=!1,this.isshowpagotarjeta=!1,this.showConfirmOperacion=!1,this.showConfirmOperacionMsj=!1,xThisCompPagoTajeta=this,xIniCompPagoTarjeta()},xopen(a){callPurchaseNumber(a)}})</script>