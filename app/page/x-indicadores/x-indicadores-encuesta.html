<dom-module id="x-indicadores-encuesta"><template is="dom"><br><br><div class="d-flexx align-items-end"><div class="mr-1"><p>Encuestas activas:</p><select class="selected-template-1"onchange="selectOptionEncuestaSelected(this)"><template is="dom-repeat"items="{{listEncuestaActiva}}"as="item"><option value="[[index]]">[[item.fecha_creacion]] - [[item.nombre]]</template></select></div><div><button class="btn btn-sm btn-info"><i class="fa fa-plus mr-1"></i> Crear Encuenta</button></div></div><table width="100%"><thead><th>Pregunta</th><template is="dom-repeat"items="{{listDataPreguntas}}"as="item"><th><div class="text-center"><img class="img-encuesta"src="{{item.img}}"alt=""><p class="fs-11">{{item.descripcion}}</div></template><tbody><template is="dom-repeat"items="{{listDataEncuesta}}"as="item"><tr><td>{{ item.pregunta }}</td><template is="dom-repeat"items="{{item.listRpt}}"as="rpt"><td align="center"><span class$="{{rpt.classCantidad}} fw-600">{{rpt.cantidad}}</span></template></template></table></template><style>.img-encuesta{width:32px}</style></dom-module><script>var xThisI2Encuensta,dataEncuesta,dataOpCalificacion;async function loadDataI2Encuesta(){xPopupLoad.xopen(),dataOpCalificacion=await $.ajax({type:"POST",url:"../../bdphp/log_005.php?op=2201"}),dataOpCalificacion=JSON.parse(dataOpCalificacion).datos,xThisI2Encuensta.listDataPreguntas=dataOpCalificacion.map(a=>(a.img="../../images/"+a.img,a));var a=await $.ajax({type:"POST",url:"../../bdphp/log_005.php?op=2202"});xThisI2Encuensta.listEncuestaActiva=JSON.parse(a).datos,xThisI2Encuensta.isShowEncuestas=0<xThisI2Encuensta.listEncuestaActiva.length,xThisI2Encuensta.isShowEncuestas&&loadDataEncuestaSelected(xThisI2Encuensta.listEncuestaActiva[0].idencuesta_sede_conf)}function loadDataEncuestaSelected(a){$.ajax({type:"POST",url:"../../bdphp/log_005.php?op=22",data:{idencuesta:a}}).done(function(a){dataEncuesta=JSON.parse(a).datos;const n=["text-danger","text-danger","text-warning","text-success","text-info"];var e=[];dataEncuesta.map((t,a)=>{var s=e.find(a=>a.idpregunta===t.idencuesta_pregunta);s||(s={idpregunta:t.idencuesta_pregunta,pregunta:t.pregunta,listRpt:[]},dataOpCalificacion.map((t,a)=>{var e=dataEncuesta.find(a=>a.idencuesta_pregunta===s.idpregunta&&t.idencuesta_respuesta===a.idencuesta_respuesta);_rowListRpt={cantidad:e?e.cantidad:0,idencuesta_respuesta:t.idencuesta_respuesta,classCantidad:n[a]},s.listRpt.push(_rowListRpt)}),e.push(s))}),xThisI2Encuensta.listDataEncuesta=e,xPopupLoad.xclose()})}function selectOptionEncuestaSelected(a){a=a.selectedIndex;loadDataEncuestaSelected(xThisI2Encuensta.listEncuestaActiva[a].idencuesta_sede_conf)}Polymer({is:"x-indicadores-encuesta",properties:{listDataEncuesta:[],listDataPreguntas:[],listEncuestaActiva:[],isShowEncuestas:Boolean},attached:function(){this.isShowEncuestas=!1,xThisI2Encuensta=this,loadDataI2Encuesta()},changeRango:a=>{},showData:()=>{loadDataI2Encuesta()},detached:function(){}})</script>