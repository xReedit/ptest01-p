<link rel="import"href="x-areas-mesas-alfanumericas.html"><dom-module id="x-areas-mesas"><template is="dom"><h3 id="titulo">Areas y Mesas</h3><p id="descripcion">Configura las áreas y mesas de tu local.<div class="xLinea2"></div><br><p class="fs-15 fw-600">Selecciona el modo de las mesas:<div class="xoptions-btn-content mb-3"><div id="btnNumerica"class="xoptions-btn-btn"activo on-click="cambiarModo"data-modo="numerica"><i class="fa fa-hashtag"></i> Numéricas (Correlativas)</div><div id="btnAlfanumerica"class="xoptions-btn-btn"on-click="cambiarModo"data-modo="alfanumerica"><i class="fa fa-font"></i> Alfanuméricas</div></div><div class="xLinea2"></div><br><div id="componenteNumerico"hidden$="{{!isModoNumerica}}"><p class="fs-15 fw-600">Mesas numéricas y correlativas<p class="text-secondary">Las mesas numéricas son correlativas y se organizan por rangos. Por ejemplo: Área "Salón Principal" con mesas del 1 al 20, Área "Salón 2" con mesas del 21 al 40.<table><thead><th class="text-left">Area<th class="text-center">Desde la mesa<th class="text-center">Hasta la mesa<th class="text-center"><tbody><tr><td><input class="selected-template-1"placeholder="Titulo del Area"id="tituloarea"onchange="conMayusculas(this)"><td class="text-center"><input class="selected-template-1 text-center"type="number"placeholder="# Mesa"id="desde"><td class="text-center"><input class="selected-template-1 text-center"type="number"placeholder="# Mesa"id="hasta"><td class="text-center"><button class="btn btn-sm btn-primary"on-click="agregarArea">+ Agregar</button><tr><td colspan="4"class="text-right text-danger fw-600 animated"id="alertMessage"style="display:none"></tr><template is="dom-repeat"items="{{listAreas}}"as="item"><tr><td>{{item.titulo}}<td class="text-center">{{item.desde}}<td class="text-center">{{item.hasta}}<td class="text-center"><span class="xDeleteRow"on-click="eliminarArea"></span></template></table><br><button class="btn btn-success"disabled$="{{!isShowBtnGuardar}}"on-click="guardarCambios"><i class="fa fa-save"></i> Guardar Cambios</button></div><div hidden$="{{!isModoAlfanumerica}}"><x-areas-mesas-alfanumericas id="componenteAlfa"on-volver-mesas-numericas="volverModoNumerico"></x-areas-mesas-alfanumericas></div></template><script>var xThisAreasMesas;Polymer({is:"x-areas-mesas",properties:{listAreas:{type:Array,value:[]},isShowBtnGuardar:{type:Boolean,value:!1},modoActual:{type:String,value:"numerica"},isModoNumerica:{type:Boolean,value:!0},isModoAlfanumerica:{type:Boolean,value:!1}},attached:function(){(xThisAreasMesas=this).loadAreas()},agregarArea:function(){var a=this.$.tituloarea.value,e=parseInt(this.$.desde.value),t=parseInt(this.$.hasta.value);if(e<0||t<0)this.showAlert("Los números de mesa no pueden ser negativos.");else if(t<e)this.showAlert('El número de mesa "hasta" no puede ser menor que el número de mesa "desde".');else{for(var s=0;s<this.listAreas.length;s++){var i=this.listAreas[s];if(e>=i.desde&&e<=i.hasta||t>=i.desde&&t<=i.hasta)return void this.showAlert("El rango de mesas se superpone con un área existente.")}this.push("listAreas",{titulo:a,descripcion:"",desde:e,hasta:t}),this.isShowBtnGuardar=!0,this.$.tituloarea.value="",this.$.desde.value="",this.$.hasta.value="",this.$.tituloarea.focus()}},eliminarArea:async function(a){var e=paramsSwalAlert,e=(e.html=`<div class="p-1" style="overflow: hidden;"><i class="fa fa-trash-o fa-2x text-danger" aria-hidden="true"></i>
                                <p class="mt-1 fs-18">Esta seguro de borrar este registro?</p>
                                </div>`,e.confirmButtonText="Si, borrar",e.cancelButtonText="Cancelar",e.showCancelButton=!0,await showAlertSwalHtmlDecision(e));e.isConfirmed&&(e=a.model.index,this.splice("listAreas",e,1),this.isShowBtnGuardar=!0)},guardarCambios:async function(){xPopupLoad.xopen();var a={listAreas:this.listAreas,op:50};(await(new httpFecht).axiosExecute({type:"POST",url:"../../bdphp/log_009.php",data:a},!0,!1)).success?xPopupLoad.xclose():(xPopupLoad.xclose(),this.showAlert("Ocurrió un error al guardar los cambios."))},showAlert:function(a){let e=this.$.alertMessage;e.textContent=a,e.classList.add("animate__flash"),$(e).fadeIn().delay(3e3).fadeOut(function(){e.classList.remove("animate__flash")})},loadAreas:async function(){var a=xm_log_get("sede_otros_datos");this.isModoAlfanumerica="1"===a[0].mesas_alfanumerica,this.isModoNumerica=!this.isModoAlfanumerica,this.isModoAlfanumerica?this.cambiarModo({currentTarget:this.$.btnAlfanumerica}):this.cambiarModo({currentTarget:this.$.btnNumerica});a=await(new httpFecht).axiosExecute({type:"POST",url:"../../bdphp/log_009.php",data:{op:5001}},!0,!1);a.success?this.listAreas=a.datos:this.showAlert("Ocurrió un error al cargar las áreas.")},cambiarModo:function(a){a=a.currentTarget.dataset.modo;this.modoActual=a,this.isModoNumerica="numerica"===a,this.isModoAlfanumerica="alfanumerica"===a,this.$.btnNumerica.removeAttribute("activo"),this.$.btnAlfanumerica.removeAttribute("activo"),("numerica"===a?this.$.btnNumerica:this.$.btnAlfanumerica).setAttribute("activo","")},getModoActivo:function(a){return this.modoActual===a},volverModoNumerico:function(){this.modoActual="numerica",this.isModoNumerica=!0,this.isModoAlfanumerica=!1}})</script></dom-module>