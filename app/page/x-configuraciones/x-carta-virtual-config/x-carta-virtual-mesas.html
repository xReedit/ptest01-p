<dom-module id="x-carta-virtual-mesas">
<template is="dom">
<div>
<h3>Codigos QR para las mesas</h3>
<p>Toca para descargar.</p>
<div class="xLinea2"></div>
<br>
<div class="content-qr">
<template is="dom-repeat" items="{{objListMesasQr}}" as="item">
<div class="codigo-qr xCursor" onclick="descarGarQR(this)" data-index=[[index]]>
<img src="{{item.codigo}}" alt="">
<span>{{item.nummesa}}</span>
</div>
</template>
</div>
<br><br>
<h3>Otros Codigos QR</h3>
<p>Toca para descargar.</p>
<div class="xLinea2"></div>
<div class="content-qr">
<template is="dom-repeat" items="{{objListOtherQr}}" as="item_o">
<div class="codigo-qr xCursor" onclick="descargarOtroQR(this)" data-index=[[index]]>
<img src="{{item_o.codigo}}" alt="">
<span>{{item_o.titulo}}</span>
</div>
</template>
</div>
<br><br>
<h3>Modelo de afiche</h3>
<p>Toca para descargar.</p>
<div class="xLinea2"></div>
<a href="{{imgAfiche}}" download>
<img class="xCursor" src="{{imgAfiche}}" alt="" width="100">
</a>
<br><br><br><br><br><br>
</div>
</template>
</dom-module>
<style>.content-qr{display:inline-block}.codigo-qr{display:inline-grid;text-align:center}</style>
<script>var xThisCartaVMesas;function xIniCartaVirtualMesas(){console.log('ini mesa carta');xThisCartaVMesas.imgAfiche=URL_IMG_CARTA+'afiche_qr_modelo.jpg';console.log('xThisCartaVMesas.imgAfiche',xThisCartaVMesas.imgAfiche);loadDatosCartaMesas();}
function loadDatosCartaMesas(){$.ajax({type:'POST',url:'../../bdphp/log_005.php?op=903'}).done(function(res){res=JSON.parse(res);xThisCartaVMesas.objListMesasQr=JSON.parse(res.datos[0].mesas);xThisCartaVMesas.objListMesasQr.map(x=>{x.codigoDownload=`https:x.codigo=`https:return x;})
xThisCartaVMesas.objListOtherQr=[];var listOther=[];xThisCartaVMesas.qrLLevar={};var _cod=res.datos[0].qr_para_llevar;xThisCartaVMesas.qrLLevar.codigoDownload=`https:xThisCartaVMesas.qrLLevar.codigo=`https:xThisCartaVMesas.qrLLevar.titulo='Solo para llevar';xThisCartaVMesas.qrDelivery={};_cod=res.datos[0].qr_delivery;xThisCartaVMesas.qrDelivery.codigoDownload=`https:xThisCartaVMesas.qrDelivery.codigo=`https:xThisCartaVMesas.qrDelivery.titulo='Delivery';listOther.push(xThisCartaVMesas.qrLLevar);listOther.push(xThisCartaVMesas.qrDelivery);xThisCartaVMesas.objListOtherQr=JSON.parse(JSON.stringify(listOther));console.log('xThisCartaVMesas.objListOtherQr',xThisCartaVMesas.objListOtherQr);});}
function descargarAfiche(){window.open(xThisCartaVMesas.imgAfiche,'Afiche',"width=500,height=500");}
function descargarOtroQR(obj){const index=obj.dataIndex;const fileDown=xThisCartaVMesas.objListOtherQr[index];const url=fileDown.codigoDownload;window.open(url,"CodigoQR","width=500,height=500");}
function descarGarQR(obj){const index=obj.dataIndex;const fileDown=xThisCartaVMesas.objListMesasQr[index];const url=fileDown.codigoDownload;window.open(url,"CodigoQR","width=500,height=500");}
Polymer({is:'x-carta-virtual-mesas',properties:{xt_org:Number,xt_idsede:Number,objListMesasQr:Object,qrLLevar:Object,qrDelivery:Object,objListOtherQr:Object,imgAfiche:String},attached:function(){xThisCartaVMesas=this;xIniCartaVirtualMesas();}})</script>