<dom-module id="x-buscar.submenu">
<script type="text/javascript" src="../../view/item_pedidos.js"></script>
<template>
<div id="contenedor-x" class="dis-flex">
<div class="xBordeDe2 posLinePedido xNoVisibleMenos720">
<x-menu small-page="true"></x-menu>
<div class="xNoVisibleMenos920">
<br><br><br>
</div>
</div>
<div class="div_submenu_p">
<div>
<input type="text" class="xMiInput xfont18 xBold" style="padding:10px" placeholder="Buscar" id="txt_parametro" onclick="this.select()">
<div class="xLinea7"></div>
<div class="xLineaSombra"></div>
</div>
<div class="xMenu_body_buscar" id="_xSubMenu_body">
<div class="xAlinearCentro spinner">
<paper-spinner active></paper-spinner>
</div>
</div>
</div>
<div class="xBordeIz2 xNoVisibleMenos720 xNoVisibleMenos920 posLinePedido">
<x-mipedido id="mipedido-view"></x-mipedido>
</div>
</div>
</template>
</dom-module>
<style>.posLinePedido{position:relative;width:41%;height:calc(100vh - 60px);overflow-y:auto}</style>
<script>/*<![CDATA[*/var xThisBuscarSubMenu,xCadenaTC="",xTituloDet,xArrayPedidoObj,xidItem_selected,xreloj_update_subItem_sel,xobj_row_selected,xidCatProcedencia,xdt_sub_Item,isSocket=false;function xxaa2(){}function xIniBuscarSubMenu(){xArrayPedidoObj=$.parseJSON(window.localStorage.getItem("::app3_sys_dta_pe"));xArmarMenuLateral(2);xCadenaTC=xArmarTipoConsumo();xLoadItemsBusquedaSubMenu();$("#txt_parametro").keyup(delay(function(a){xLoadItemsBusquedaSubMenu()},600));$(document.body).on("click","#_xSubMenu_body div.xmenu_item_2",function(c){xobj_row_selected=$(this);const f=xobj_row_selected.data("index");itemPedidos_objItemSelected=xdt_sub_Item[f];itemPedidos_objItemSelected.stock_actual=itemPedidos_objItemSelected.cantidad;if(xobj_row_selected.find("input:radio")[0].disabled==true){c.stopPropagation();c.stopImmediatePropagation();return false}xobj_row_selected.find("input:radio")[0].checked=true;_busqueda_xVerificarCheckItem();var d;var a="";var b;xTituloDet=itemPedidos_objItemSelected.des_seccion;xidItem=itemPedidos_objItemSelected.idcarta_lista;_xcantidad=itemPedidos_objItemSelected.cantidad;xidItem_selected=xidItem;xobj_row_selected.find(".xpedir_row").each(function(e,g){b=$(g).attr("data-id");if(xArrayPedidoObj[b][xidItem]!=null){xidTipoConsumo=b;d=xArrayPedidoObj[xidTipoConsumo][xidItem].cantidad;a=xArrayPedidoObj[xidTipoConsumo][xidItem].indicaciones;$(g).find(".xCant_item").text(xCeroIzq(d,2))}});xobj_row_selected.find("#txt_referencia").val(a);c.stopPropagation();c.stopImmediatePropagation();c.preventDefault();if(_xcantidad==="ND"){return}clearInterval(xreloj_update_subItem_sel);_Busqueda_xUpdateStockSubItem_selected();xreloj_update_subItem_sel=setInterval(function(){_Busqueda_xUpdateStockSubItem_selected()},5000);return false})}function _busqueda_xVerificarCheckItem(){$(".xmenu_item_2 .xcheck_item").each(function(a,b){if($(b).is(":checked")){$(this).parent().addClass("xitem_seleccionado")}else{$(this).parent().removeClass("xitem_seleccionado")}})}function xLoadItemsBusquedaSubMenu(){$(".xMenu_body_buscar").html('<div class="xAlinearCentro spinner"><paper-spinner active></paper-spinner></div>').trigger("create");$("#xtitulo_bar").text("Buscar");const a=txt_parametro.value;$.ajax({type:"POST",url:"../../bdphp/log.php?op=2053",data:{i:xidCategoria,parametro:a}}).done(function(m){xdt_sub_Item=$.parseJSON(m);var k="",j="",l="",c="",e="",b="",g,f="",d="";xdt_sub_Item=xdt_sub_Item.datos;for(var h=0;h<xdt_sub_Item.length;h++){f="";g=xdt_sub_Item[h].cantidad;d=xClassEstadoItem(g);xClassEstado=d.split("|")[0];d=d.split("|")[1];if(g<=0){f="disabled"}j='<input class="xcheck_item" type="radio" name="option" data-index='+h+' value="other" '+f+'><p class="xprecio_item xEnLinea">'+xdt_sub_Item[h].precio+'</p><div id class="xstock_item '+d+'"><span>stock</span><p class="num_stock">'+xCeroIzq(g,2)+'</p></div><p class="xtitulo_item xEnLinea">'+xdt_sub_Item[h].des_item+"</p>";l="";if(xdt_sub_Item[h].img!=""){c='<img src="../img/'+xdt_sub_Item[h].img+'">';l="1"}if(xdt_sub_Item[h].detalle!=""){e='<div class="xsub_titulo_item">'+xMayusculaPrimera(xdt_sub_Item[h].detalle)+"</div>";l="1"}if(l=="1"){l='<div class="xdescripcion_foto">'+e+c+"</div>"}else{l=""}b='<div class="xdetalle_item">'+l+'<div class="xreferencia_item"><input type="text" autocomplete="on" placeholder="Escribe aqui las especificaciones..." class="xMiTextReferencia" id="txt_referencia"></div>'+xCadenaTC+"</div></div>";k=String(k+'<div onclick="xxaa2();" class="xmenu_item_2 xPading10 '+xClassEstado+'" data-index='+h+' data-id="'+xdt_sub_Item[h].idcarta_lista+'" data-item="'+xdt_sub_Item[h].iditem+'" data-idseccion="'+xdt_sub_Item[h].idseccion+'" data-idseccionindex="'+xdt_sub_Item[h].idseccion_index+'" data-desseccion="'+xdt_sub_Item[h].des_seccion+'" data-cantidad="'+xdt_sub_Item[h].cantidad+'" data-idimpresora="'+xdt_sub_Item[h].idimpresora+'" data-idprocede="'+xdt_sub_Item[h].idprocede+'" data-procede="'+xdt_sub_Item[h].procede+'" data-procedeindex="'+xdt_sub_Item[h].procede_index+'" data-imprimircomanda="'+xdt_sub_Item[h].imprimir_comanda+'" data-iddescontar="'+xdt_sub_Item[h].idprocede+'" data-cant_descontar="'+xdt_sub_Item[h].cant_descontar+'" data-idalmacen_items="'+xdt_sub_Item[h].idalmacen_items+'">'+j+b)}$("#_xSubMenu_body div").remove();$("#_xSubMenu_body .spinner").remove();$("#_xSubMenu_body").append(k).trigger("create");$(window).scrollTop(window.localStorage.getItem("::app3_sys_scroll_pos")||0)})}function _Busqueda_xUpdateStockSubItem_selected(){xidCatProcedencia=$(xobj_row_selected).attr("data-procede");if(xidCatProcedencia!=="1"){xidItem_selected=$(xobj_row_selected).attr("data-idalmacen_items")}$.ajax({type:"POST",url:"../../bdphp/log.php?op=2043",data:{i:xidItem_selected,p:xidCatProcedencia}}).done(function(a){xClassEstadoStock=xClassEstadoItem(a);xClassEstado=xClassEstadoStock.split("|")[0];xClassEstadoStock=xClassEstadoStock.split("|")[1];$(xobj_row_selected).addClass(xClassEstado);$(xobj_row_selected).find(".xstock_item").addClass(xClassEstadoStock);$(xobj_row_selected).find(".num_stock").text(xCeroIzq(a,2))})}Polymer({is:"x-buscar.submenu",properties:{xt_org:Number,xt_idsede:Number,xt_idus:Number},attached:function(){xThisBuscarSubMenu=this;xIniBuscarSubMenu()},detached:function(){clearInterval(xreloj_update_subItem_sel)}});/*]]>*/</script>