<dom-module id="x-porcion-main"><link rel="import"href="./x-porcion-detalle.html"><template><paper-dialog modal id="dialog_additem_porcion"class="dialog_redondo"modal entry-animation="scale-up-animation"style="max-width:600px"exit-animation="fade-out-animation"with-backdrop><div class="xContent"><h3>Agregar Porcion</h3><br><p><strong>Elaborar porciones para las recetas.</strong><br>Por ejemplo: de 1000gr de bistec salen 10 porciones de 100gr cada una para el preparar bistec a lo pobre.<br>Utilize la misma unidad de medida que esta en el producto a porcionar. Es decir si el producto a porcionar esta en gramos la misma unidad de medida debe ser para las prociones.</p><br><form id="frm_add_porcion"><input id="descripcion"name="descripcion"placeholder="Descripcion de la porcion"class="xMiInput xPasarEnter2"onchange="conMayusculas(this)"autofocus required espaciar><br><input id="peso"name="peso"placeholder="Peso"class="xMiInput xPasarEnter2"onchange="conMayusculas(this)"autofocus required espaciar><br><input id="stock"name="stock"placeholder="Cantidad"class="xMiInput xPasarEnter2"onchange="conMayusculas(this)"autofocus required espaciar><br><div class="xInvisible"><input id="idporcion"name="idporcion"> <input id="idorg"name="idorg"> <input id="idsede"name="idsede"></div></form><br><br><div class="xBoton2 xAzul"onclick="xGuardarItemPorcionPorcion()">Listo, guardar</div><div class="xBoton2 xPlomo"dialog-dismiss>Cancelar</div><br><br><br></div></paper-dialog><div class="p-2"><br><div class="xMiCard xradius"style="width:90%;max-width:1250px"><div class="xEncanezadoCard d-flexx justify-content-between"style="background:#fff0f5;color:#424242"><div class="div-content-head-op"><p class="fw-600 fs-18">Porciones<p class="fw-100 text-secondary fs-12">Lista de porciones que son parte de recetas.</div><div><button class="btn btn-sm btn-secondary"hidden$="[[!isShowDetallePorcion]]"onclick="goMainPorcion()">Atras</button></div></div><div class="p-3 mb-5"><div hidden$="[[isShowDetallePorcion]]"><input class="xMiInput"placeholder="Buscar"inline id="txt_buscar_porcion"><div class="xBoton2 xAzul xDerecha"onclick="dialog_additem_porcion.open()">+ Agregar Porcion</div><br><br><br><div class="xLinea2"></div><br><table width="100%"><thead><th align="left"width="20%">Familia<th align="left">Porcion<th align="left"width="90px">Stock<th width="5px"><tbody><template is="dom-repeat"items="{{listPorciones}}"as="item"><tr data-id="[[item.idporcion]]"onclick="xGoDetallePorcion(this)"><td>{{ item.familia }}<td class="xCursor">{{ item.porcion }}<td class="sumar_stock xCursor">{{ item.stock }}<td><button data-id="[[item.idporcion]]"onclick="xGoDetallePorcion(this)"class="btn btn-sm btn-xsm xBoton_flat_2">Detalle</button></template></table><br><br><br></div><div hidden$="[[!isShowDetallePorcion]]"><x-porcion-detalle objporcion$="[[objPorcion]]"></x-porcion-detalle></div></div></div></div></template></dom-module><script>var xThisProPor;function xIniPorcion(){$("#Titulo_page").text("Porciones"),xLoadPorciones(),$("body").addClass("loaded")}function xGuardarItemPorcionPorcion(){xvalidateFormInput("frm_add_porcion",function(o){!1!==o&&(xPopupLoad.xopen(),$("#frm_add_porcion #idorg").val(xIdOrg),$("#frm_add_porcion #idsede").val(xIdSede),$.post("../../bdphp/ManejoBD_IUD.php?tb=porcion",$("#frm_add_porcion").serialize(),function(o){xLoadPorciones(),xPopupLoad.xclose(),dialog_additem_porcion.close()}))})}function xLoadPorciones(){xPopupLoad.xopen(),$.ajax({type:"POST",url:"../../bdphp/log.php?op=1803"}).done(function(o){var i,r="",a=(a=$.parseJSON(o)).datos.map(o=>(o.modificado=!1,o));xThisProPor.listPorciones=a;for(var n=0;n<a.length;n++)i=a[n].stock,r=String(r+'<tr class="row" data-idp="'+a[n].idporcion+'"><td>'+a[n].familia+'</td><td class="xCursor"><span onclick="xModRow(this,3);" id="td_des" data-valorginal="'+a[n].porcion+'">'+a[n].porcion+'</span></td><td class="sumar_stock xCursor" onclick="xModRow(this,2);" id="td_stock" data-valorginal="'+i+'" data-mod-stock="'+i+'" data-colummn="stock">'+i+'</td><td><span class="xDeleteRowNeutro" title="Borrar" onclick="xBorrarProcion(this);"></span></td></tr>');$("#tb_porcion .row").remove(),xPopupLoad.xclose()})}function xGoDetallePorcion(o){const i=o.dataId;o=xThisProPor.listPorciones.filter(o=>o.idporcion===i)[0];xThisProPor.objPorcion=o,xThisProPor.isShowDetallePorcion=!0}function goMainPorcion(){xLoadPorciones(),xThisProPor.isShowDetallePorcion=!1}Polymer({is:"x-porcion-main",properties:{listPorciones:Object,objPorcion:[],isShowDetallePorcion:Boolean},attached:function(){this.isShowDetallePorcion=!1,xThisProPor=this,xIniPorcion()}})</script>