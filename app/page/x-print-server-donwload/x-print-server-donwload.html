<script src="search-print-server.js"></script><dom-module id="x-print-server-donwload"><template><style>:host{display:block;padding:20px}.download-container{max-width:900px;margin:0 auto}.download-cards{display:flex;flex-wrap:wrap;gap:20px;justify-content:center;margin-top:30px}.download-card{background:#fff;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,.1);padding:30px;text-align:center;width:250px;transition:transform .3s ease,box-shadow .3s ease;cursor:pointer}.download-card:hover{transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,.15)}.download-card img{width:80px;height:80px;margin-bottom:15px}.download-card h3{margin:0 0 10px 0;color:#333;font-size:1.4em}.download-card p{color:#666;font-size:.9em;margin:0 0 20px 0}.download-card .version{color:#999;font-size:.8em;margin-bottom:15px}.btn-download{background:#4caf50;color:#fff;border:none;padding:12px 25px;border-radius:25px;font-size:1em;cursor:pointer;transition:background .3s ease;display:inline-flex;align-items:center;gap:8px}.btn-download:hover{background:#45a049}.btn-download.windows{background:#0078d4}.btn-download.windows:hover{background:#006cbe}.btn-download.linux{background:#e95420}.btn-download.linux:hover{background:#d4491c}.btn-download.android{background:#3ddc84}.btn-download.android:hover{background:#32c973}.info-section{background:#f5f5f5;border-radius:8px;padding:20px;margin-top:40px}.info-section h4{margin-top:0;color:#333}.info-section ul{color:#555;line-height:1.8}.icon-download{width:16px;height:16px}.server-status-container{margin:20px 0;padding:15px 20px;border-radius:8px;display:flex;align-items:center;gap:10px}.server-status-container.checking{background:#fff3cd;border:1px solid #ffc107;color:#856404}.server-status-container.online{background:#d4edda;border:1px solid #28a745;color:#155724}.server-status-container.offline{background:#f8d7da;border:1px solid #dc3545;color:#721c24}.status-icon{font-size:1.5em}.btn-open-server{background:#28a745;color:#fff;border:none;padding:8px 20px;border-radius:20px;cursor:pointer;margin-left:auto}.btn-open-server:hover{background:#218838}.spinner{width:20px;height:20px;border:3px solid #f3f3f3;border-top:3px solid #856404;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style><div class="download-container"><h3>SERVIDOR DE IMPRESIÓN</h3><h4 class="text-danger">El servidor de impresión no esta instalado en este dispositivo.</h4><br><div class="xLinea2"></div><p>Descargue e instale el servidor de impresión en el dispositivo que estará conectado a las impresoras.<div class="download-cards"><div class="download-card"><img src="../../../images/os_windows.png"alt="Windows"onerror='this.src="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22%230078D4%22><path d=%22M0 3.5l9.9-1.4v9.5H0zm11 -1.6L24 0v11.5H11zM0 12.5h9.9v9.5L0 20.5zm11 0h13V24l-13-1.8z%22/></svg>"'><h3>Windows</h3><p>Compatible con Windows 7, 8, 10 y 11<div class="version">Versión: 1.0.0</div><button class="btn-download windows"onclick='xDownloadPrintServer("windows")'><iron-icon icon="file-download"></iron-icon>Descargar</button></div><div class="download-card"><img src="../../../images/os_linux.png"alt="Linux"onerror='this.src="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22%23E95420%22><circle cx=%2212%22 cy=%2212%22 r=%2210%22/><text x=%2212%22 y=%2216%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%228%22>L</text></svg>"'><h3>Linux</h3><p>Compatible con Ubuntu, Debian y derivados<div class="version">Versión: 1.0.0</div><button class="btn-download linux"onclick='xDownloadPrintServer("linux")'><iron-icon icon="file-download"></iron-icon>Descargar</button></div><div class="download-card"><img src="../../../images/os_android.png"alt="Android"onerror='this.src="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22%233DDC84%22><path d=%22M6 18c0 .55.45 1 1 1h1v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h2v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h1c.55 0 1-.45 1-1V8H6v10zM3.5 8C2.67 8 2 8.67 2 9.5v7c0 .83.67 1.5 1.5 1.5S5 17.33 5 16.5v-7C5 8.67 4.33 8 3.5 8zm17 0c-.83 0-1.5.67-1.5 1.5v7c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-7c0-.83-.67-1.5-1.5-1.5zm-4.97-5.84l1.3-1.3c.2-.2.2-.51 0-.71-.2-.2-.51-.2-.71 0l-1.48 1.48A5.84 5.84 0 0012 1c-.96 0-1.86.23-2.66.63L7.85.15c-.2-.2-.51-.2-.71 0-.2.2-.2.51 0 .71l1.31 1.31A5.983 5.983 0 006 7h12c0-1.99-.97-3.75-2.47-4.84zM10 5H9V4h1v1zm5 0h-1V4h1v1z%22/></svg>"'><h3>Android</h3><p>Compatible con Android 6.0 o superior<div class="version">Versión: 1.0.0</div><button class="btn-download android"onclick='xDownloadPrintServer("android")'><iron-icon icon="file-download"></iron-icon>Descargar</button></div></div><div class="info-section"><h4>Instrucciones de instalación</h4><ul><li><strong>Windows:</strong> Ejecute el instalador y siga las instrucciones en pantalla. El servidor se iniciará automáticamente.<li><strong>Linux:</strong> Descomprima el archivo y ejecute el script de instalación con permisos de administrador.<li><strong>Android:</strong> Descargue el APK e instálelo. Debe habilitar la instalación de fuentes desconocidas.</ul><br><h4>Requisitos</h4><ul><li>Conexión a la misma red que el sistema de ventas<li>Impresora térmica conectada al dispositivo (USB, Bluetooth o Red)<li>El dispositivo debe permanecer encendido para recibir trabajos de impresión</ul></div></div></template></dom-module><script>var xThisPrintServerDownload,currentServerInfo=null;function xIniPrintServerDownload(){$("#panel_toolbar").show(),$("body").addClass("loaded"),$("#Titulo_page").text("Servidor de Impresión"),checkServerStatus()}async function checkServerStatus(){var e,r,n=document.getElementById("serverStatusContainer");try{(currentServerInfo=await PrintServerDetector.detectInstalledServer()).installed?(e="new"===currentServerInfo.serverType?"Nueva versión":"Laragon",r=currentServerInfo.version?" v"+currentServerInfo.version:"",n.className="server-status-container online",n.innerHTML=`
				<span class="status-icon">✓</span>
				<span><strong>Servidor detectado:</strong> ${e}${r}</span>
				<button class="btn-open-server" onclick="openDetectedServer()">Abrir Servidor</button>
			`):(n.className="server-status-container offline",n.innerHTML=`
				<span class="status-icon">✗</span>
				<span><strong>No se detectó</strong> ningún servidor de impresión instalado en este equipo.</span>
				<button class="btn-open-server" style="background:#6c757d;" onclick="checkServerStatus()">Reintentar</button>
			`)}catch(e){n.className="server-status-container offline",n.innerHTML=`
			<span class="status-icon">✗</span>
			<span>Error al verificar el servidor de impresión.</span>
			<button class="btn-open-server" style="background:#6c757d;" onclick="checkServerStatus()">Reintentar</button>
		`}}function openDetectedServer(){var e;currentServerInfo&&currentServerInfo.installed&&(e=PrintServerDetector.getRedirectUrl(currentServerInfo))&&window.open(e,"Servidor de Impresion")}function xDownloadPrintServer(e){var r={windows:"https://papaya-comercio-files.s3.us-east-2.amazonaws.com/installers/RestobarPrintServer-Setup-Win64.exe",linux:"https://papaya-comercio-files.s3.us-east-2.amazonaws.com/installers/restobar-print-server_amd64.deb",android:"https://papaya-comercio-files.s3.us-east-2.amazonaws.com/installers/app-print-server.apk"}[e];r&&""!==r?window.open(r,"_blank"):xShowMensajeToast("La descarga para "+e+" aún no está disponible")}Polymer({is:"x-print-server-donwload",properties:{xt_org:Number,xt_idsede:Number},attached:function(){xThisPrintServerDownload=this,xIniPrintServerDownload()}})</script>