<dom-module id="x-planilla-colaborador-file"><template is="dom"><paper-dialog class="dialog_redondo"id="dialog_borrar"entry-animation="scale-up-animation"exit-animation="fade-out-animation"with-backdrop><div class="xtxtCentro"><img src="../../../images/_dlg_remove.gif"alt=""width="150px"></div><p>Esta seguro de querer borrar este registro?</p><br><div class="buttons"><button class="xBoton2 xPlomo"dialog-dismiss>Cancelar</button> <button class="xBoton2 xRojo"onclick="xDlgBorrar()">Si, borrar</button></div></paper-dialog><paper-dialog class="dialog_redondo"id="dialog_baja"entry-animation="scale-up-animation"exit-animation="fade-out-animation"with-backdrop><br><h4>Esta seguro de querer dar de baja a este colaborador?</h4><br><div class="buttons"><button class="xBoton2 xPlomo"dialog-dismiss>Cancelar</button> <button class="xBoton2 xRojo"onclick="xDarDeBaja()">Si, borrar</button></div></paper-dialog><paper-dialog class="dialog_redondo"id="dialog_new_planilla_detalle"style="width:345px"modal entry-animation="scale-up-animation"exit-animation="fade-out-animation"><div><h4 class$="[[classDialog]]">Nuevo {{titulo_dialog}}.</h4></div><div><br><form id="form_new_planilla_detalle"method="POST"><input class="xMiInput xPasarEnter2"placeholder="CONCEPTO"onchange="conMayusculas(this)"id="descripcion"name="descripcion"espaciar required> <input type="number"class="xMiInput xPasarEnter2"placeholder="IMPORTE"onchange="conMayusculas(this)"id="importe"name="importe"espaciar required><div class="xInvisible"><input id="idplanilla"name="idplanilla"> <input id="tipo"name="tipo"value$="[[tipo_registro]]"> <input id="fecha"name="fecha"> <input id="mes_activo"name="mes_activo"></div></form><br><br><button dialog-dismiss id="dlg_sunat_btn"onclick="newPlanillaDetalle()"class="xBoton2 xVerde">Listo Guardar</button> <button dialog-dismiss class="xBoton2 xRojo">Cerrar</button></div></paper-dialog><br><br><div class="xMiCard xradius animated fadeIn myDivToPrint"style="width:85%"id="myDivToPrint"><div class="xContentCard"><div class="xDerecha xBtnNoPrint"style="text-align:right"><button class="xBoton2 xAzul"onclick="window.history.back()">Regresar</button> <button class="xBoton2 xVerde"onclick="imprimirFile()">Imprimir</button> <button class="xBoton2 xRojo"hidden$="{{dataEnca.debaja}}"onclick="dialog_baja.open()">Dar de baja</button></div><div><h3>{{dataEnca.nombres}} | {{dataEnca.dni}}</h3><p>Cargo: <strong>{{dataEnca.descargo}}</strong><p>Profesion: <strong>{{dataEnca.profesion}}</strong><div class="xDerecha"style="text-align:right"><h3>{{ dataEnca.mes_corresponte }}</h3></div><p>Area: <strong>{{dataEnca.area}}</strong><p>F. Ingreso: <strong>{{dataEnca.f_ingreso}} | {{dataEnca.tiempo_laborando}} DE SERVICIO.</strong><div hidden$="{{!dataEnca.debaja}}"><p class="xColorRow_Rojo">F. de baja: <strong>{{dataEnca.fecha_baja}}</strong></div></div><br><div class="xLinea2"></div><div class="x_div_linea"><div id="div_ingresos"class="xitem1 xBordeDe"style="height:50vh;overflow-y:auto"><div hidden$="{{dataEnca.debaja}}"><paper-fab mini icon="add"onclick="_newIngreso()"title="Agregar"tabindex="0"class="xDerecha xBtnNoPrint"style="top:30px;margin:-5px"></paper-fab><h4>Ingresos</h4></div><table style="width:100%"><thead><th align="left">Concepto<th align="right">Importe<th width="20px"><tbody><tr><td>REMUNERACION BASICA MENSUAL<td align="right">{{dataEnca.sueldo}}<td></tr><template is="dom-repeat"items="{{ListIngresos}}"as="item"><tr data-t="planilla_detalle"data-id="{{item.idplanilla_detalle}}"class="animated fadeIn fast"id="{{index}}"onclick="_setSelIngreso(this)"><td><span class="xfont9 xColorRow_Plomo">{{item.fecha}}</span> {{item.descripcion}}<td align="right">{{item.monto}}<td><span class="xDeleteRow2"title="Anular"onclick="xDialogBorrarObj(this)"></span></template><tr><td colspan="2"align="right"><span class="xfont14 xBold">{{sumListIngresos}}</span><td></table></div><div id="div_descuentos"class="xitem2"><div hidden$="{{dataEnca.debaja}}"><paper-fab mini icon="add"onclick="_newDescuento()"title="Agregar"tabindex="0"class="xDerecha xBtnNoPrint"style="top:30px;margin:-5px"></paper-fab><h4>Descuentos</h4></div><table style="width:100%"><thead><th align="left">Concepto<th align="right">Importe<th><tbody><template is="dom-repeat"items="{{ListDescuentos}}"as="item"><tr data-t="planilla_detalle"data-id="{{item.idplanilla_detalle}}"class="animated fadeIn fast"id="{{index}}"onclick="_setSelIngreso(this)"><td><span class="xfont9 xColorRow_Plomo">{{item.fecha}}</span> {{item.descripcion}}<td align="right">{{item.monto}}<td><span class="xDeleteRow2"title="Anular"onclick="xDialogBorrarObj(this)"></span></template><tr><td colspan="2"align="right"><span class="xfont14 xBold">{{sumListDescuentos}}</span><td></table></div></div><div class="xLinea2"></div><br><div class="xIzquierda"><p>Cuenta de abono: <strong>{{ dataEnca.cuenta }}</strong></div><div class="xDerecha"style="text-align:right"><p class="xfont20">Neto a pagar: <strong>{{ netoPagar }}</strong></div><br><br></div></div></template></dom-module><style></style><script>var xThisPColFile,dataUrl,_mesactivo;function xIniPlanillaDetalle(){var a=router.activeRoute.baseURI.split("?");dataUrl=JSON.parse(atob(a[1])),xLoadPlanillaColaborador(),$("body").addClass("loaded")}function xLoadPlanillaColaborador(){$.ajax({type:"POST",url:"../../bdphp/log_005.php?op=503",data:{id:dataUrl.id,mes:dataUrl.mes}}).done(a=>{a=JSON.parse(a);xThisPColFile.dataEnca=a.datos.map(a=>(a.tiempo_laborando=xTiempoTrascurridoYYMMDD(a.laborando),a.fecha_baja=null===a.fecha_baja?"":a.fecha_baja,a.debaja=""!=a.fecha_baja,a.mes_corresponte=xDesMes(parseInt(dataUrl.mes.split("/")[0])-1)+" "+dataUrl.mes.split("/")[1],a))[0],xloadDetallesPlanilla()})}function xloadDetallesPlanilla(){$.ajax({type:"POST",url:"../../bdphp/log_005.php?op=5031",data:{id:dataUrl.id,mes:dataUrl.mes}}).done(a=>{var a=JSON.parse(a),l=parseFloat(xThisPColFile.dataEnca.sueldo.replace(",","")),o=0;xThisPColFile.ListIngresos=a.datos.filter(a=>"0"===a.tipo).map(a=>(l+=parseFloat(a.importe),a)),xThisPColFile.ListDescuentos=a.datos.filter(a=>"1"===a.tipo).map(a=>(o+=parseFloat(a.importe),a)),xThisPColFile.sumListIngresos=numeroConComas(l.toFixed(2)),xThisPColFile.sumListDescuentos=numeroConComas(o.toFixed(2)),xThisPColFile.netoPagar=numeroConComas((l-o).toFixed(2))})}function newPlanillaDetalle(){xPopupLoad.xopen();var a=$("#form_new_planilla_detalle");a.find("#fecha").val(xDevolverFecha()),a.find("#idplanilla").val(dataUrl.id),a.find("#mes_activo").val(dataUrl.mes),xvalidateForm("form_new_planilla_detalle",function(a){!1!==a&&$.post("../../bdphp/ManejoBD_IUD.php?tb=planilla_detalle",$("#form_new_planilla_detalle").serialize(),function(a){xPopupLoad.xclose(),$("#form_new_planilla_detalle").reset(),xPopupLoad.xclose(),dialog_new_planilla_detalle.close(),xloadDetallesPlanilla()})})}function _newIngreso(){xThisPColFile.titulo_dialog="Ingreso",xThisPColFile.tipo_registro=0,xThisPColFile.classDialog="dialog_titulo xFondoColorVerde",dialog_new_planilla_detalle.open()}function _newDescuento(){xThisPColFile.titulo_dialog="Descuento",xThisPColFile.tipo_registro=1,xThisPColFile.classDialog="dialog_titulo xFondoColorRojo",dialog_new_planilla_detalle.open()}function xDarDeBaja(){$.ajax({type:"POST",url:"../../bdphp/log_005.php?op=505",data:{id:dataUrl.id}}).done(a=>{dialog_baja.close()})}function xDialogBorrarObj(a,l){xObjBorrar=a,dialog_borrar.open()}function xDlgBorrar(){xBorrarItem(xObjBorrar),dialog_borrar.close(),xloadDetallesPlanilla()}function imprimirFile(){$(".xBtnNoPrint").attr("hidden",!0),setTimeout(()=>{PrintElemDiv("myDivToPrint","Boleta de Pago")},500),setTimeout(()=>{$(".xBtnNoPrint").attr("hidden",!1)},2e3)}Polymer({is:"x-planilla-colaborador-file",properties:{xt_org:Number,xt_idsede:Number,titulo_dialog:String,tipo_registro:Number,classDialog:String,dataEnca:[],listDetalle:[],ListIngresos:[],ListDescuentos:[],sumListIngresos:String,sumListDescuentos:String,netoPagar:String},attached:function(){xThisPColFile=this,xIniPlanillaDetalle()},displayIndex:function(a){return xCeroIzq(a+1,1)}})</script>