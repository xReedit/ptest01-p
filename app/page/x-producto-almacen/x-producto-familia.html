<dom-module id="x-producto-familia"><template><paper-dialog modal id="dialog_modificar_stock_porcion"class="dialog_redondo"modal entry-animation="scale-up-animation"style="max-width:600px"exit-animation="fade-out-animation"with-backdrop><div class="xContent"><h3>Modificar Stock</h3><span class="fw-100 text-secondary fs-11">Todas las modificaciones se registrar√°n en el historial de cambios.</span><div class="xLinea2"></div><br><div class="d-flexx justify-content-between"><div style="max-width:90px"><p class="fs-12 text-secondary m-0">Stock Actual<p class="fs-15 fw-600">{{objporcion.stock}}</div><div class="w-50"><p class="fs-15 text-dark m-0 fw-600">Cual es el nuevo Stock?</p><input type="number"id="stock_new"placeholder="Ingrese nuevo stock"class="xMiInput xPasarEnter2"onkeyup="changeStockPorcion(this.value)"></div></div><br><p class$="{{classMsjStock}}">{{ msjStock }}</p><br><button class="btn btn-sm btn-primary"onclick="saveStockModifyPorcion()">Listo, guardar</button> <button class="btn btn-sm btn-secondary"dialog-dismiss>Cancelar</button></div></paper-dialog><div><div class="d-flexx justify-content-between align-items-center"><div class="d-flexx"><h3>Lista de Familias</h3></div></div><div><br><br><p class="fs-18 text-secondary">Familias<hr><table class="w-100"><thead><th>#<th>Descripcion<th>Porductos Relacionados<th><tbody><template is="dom-repeat"items="{{listFamilias}}"as="item"><tr><td>{{displayIndex(index)}}<td data-id="[[item.idproducto_familia]]"class="xCursor"onclick="xgoModificarFamilia(this)"><p hidden$="[[item.edit]]">{{item.descripcion}}</p><input data-id="[[item.idproducto_familia]]"hidden$="[[!item.edit]]"class="xMiInput xPasarEnter2"onchange="conMayusculas(this)"onblur="xSaveModificacionFamilia(this)"value="{{item.descripcion}}"><td>{{item.cantidad_relacionados}}<td><i data-id="[[item.idproducto_familia]]"class="fa fa-trash text-danger xCursor"onclick="xRemoveFamilia(this)"></i></template></table></div></div></template></dom-module><script>let xthisProductoFamilias,familiaSeletedEdit;async function xIniLoadProductosFamilias(){xPopupLoad.xopen();var a=await(new httpFecht).postJson("../../bdphp/log_009.php?op=112");a.success&&(xthisProductoFamilias.listFamilias=a.datos.map(a=>(a.edit=!1,a))),xPopupLoad.xclose()}function xgoModificarFamilia(a){xGetItemFamilia(a).edit=!0,xSetearDataFamlia()}function xSetearDataFamlia(){xthisProductoFamilias.listFamilias=JSON.parse(JSON.stringify(xthisProductoFamilias.listFamilias))}async function xRemoveFamilia(a){const i=xGetItemFamilia(a);var a=0<i.cantidad_relacionados?`tiene ${i.cantidad_relacionados} productos relacionados.`:"",t=paramsSwalAlert;t.title='<p class="fw-600 fs-18">Borrar Familia</p>',t.html=`<div class="pb-2" style="display: inline-flex;">                    
                                    <p>Esta seguro de borrar la familia de productos: <strong>${i.descripcion}</strong> ${a}</p>
                                </div>`,t.confirmButtonText="Si, borrar",t.showCancelButton=!0,await showAlertSwalHtmlDecision(t,1).then(async a=>{a.isConfirmed&&(await(new httpFecht).postJson("../../bdphp/log_009.php?op=113",i),xIniLoadProductosFamilias())})}function xGetItemFamilia(a){const i=a.dataId;return xthisProductoFamilias.listFamilias.filter(a=>a.idproducto_familia===i)[0]}async function xSaveModificacionFamilia(a){var i=xGetItemFamilia(a);i.descripcion=a.value,i.edit=!1,xSetearDataFamlia();await(new httpFecht).postJson("../../bdphp/log_009.php?op=114",i)}Polymer({is:"x-producto-familia",properties:{listFamilias:[]},attached:function(){xthisProductoFamilias=this,xIniLoadProductosFamilias()},displayIndex:function(a){return xCeroIzq(a+1,1)}})</script>