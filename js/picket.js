!function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):"object"==typeof window?window.Picker=e(jQuery):this.Picker=e(jQuery)}(function(m){function g(i,o,r,e){function a(){return g._.node("div",g._.node("div",g._.node("div",g._.node("div",h.component.nodes(u.open),f.box),f.wrap),f.frame),f.holder,'tabindex="-1"')}function d(){h.$holder.on({keydown:s,"focus.toOpen":t,blur:function(){p.removeClass(f.target)},focusin:function(e){h.$root.removeClass(f.focused),e.stopPropagation()},"mousedown click":function(e){var t=v(e,i);t!=h.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||m(t).is("input, select, textarea, button, option")||(e.preventDefault(),h.$holder.eq(0).focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=m(this),t=e.data(),e=e.hasClass(f.navDisabled)||e.hasClass(f.disabled),n=(n=_())&&(n.type||n.href?n:null);(e||n&&!m.contains(h.$root[0],n))&&h.$holder.eq(0).focus(),!e&&t.nav?h.set("highlight",h.component.item.highlight,{nav:t.nav}):!e&&"pick"in t?(h.set("select",t.pick),l.closeOnSelect&&h.close(!0)):t.clear?(h.clear(),l.closeOnClear&&h.close(!0)):t.close&&h.close(!0)})}function t(e){e.stopPropagation(),p.addClass(f.target),h.$root.addClass(f.focused),h.open()}function s(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(27==t)return h.close(!0),!1;(32==t||n||!u.open&&h.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?h.clear().close():h.open())}var c,u,l,f,p,h;return i?(c=!1,u={id:i.id||"P"+Math.abs(~~(Math.random()*new Date)),handlingOpen:!1},l=r?m.extend(!0,{},r.defaults,e):e||{},f=m.extend({},g.klasses(),l.klass),p=m(i),h=(e=function(){return this.start()}).prototype={constructor:e,$node:p,start:function(){return u&&u.start?h:(u.methods={},u.start=!0,u.open=!1,u.type=i.type,i.autofocus=i==_(),i.readOnly=!l.editable,i.id=i.id||u.id,"text"!=i.type&&(i.type="text"),h.component=new r(h,l),h.$root=m('<div class="'+f.picker+'" id="'+i.id+'_root" />'),y(h.$root[0],"hidden",!0),h.$holder=m(a()).appendTo(h.$root),d(),l.formatSubmit&&(!0===l.hiddenName?(n=i.name,i.name=""):n=(n=["string"==typeof l.hiddenPrefix?l.hiddenPrefix:"","string"==typeof l.hiddenSuffix?l.hiddenSuffix:"_submit"])[0]+i.name+n[1],h._hidden=m('<input type=hidden name="'+n+'"'+(p.data("value")||i.value?' value="'+h.get("select",l.formatSubmit)+'"':"")+">")[0],p.on("change."+u.id,function(){h._hidden.value=i.value?h.get("select",l.formatSubmit):""})),p.data(o,h).addClass(f.input).val(p.data("value")?h.get("select",l.format):i.value).on("focus."+u.id+" click."+u.id,function(e){e.preventDefault(),h.open()}).on("mousedown",function(){u.handlingOpen=!0;var e=function(){setTimeout(function(){m(document).off("mouseup",e),u.handlingOpen=!1},0)};m(document).on("mouseup",e)}),l.editable||p.on("keydown."+u.id,s),y(i,{haspopup:!0,expanded:!1,readonly:!1,owns:i.id+"_root"}),l.containerHidden?m(l.containerHidden).append(h._hidden):p.after(h._hidden),l.container?m(l.container).append(h.$root):p.after(h.$root),h.on({start:h.component.onStart,render:h.component.onRender,stop:h.component.onStop,open:h.component.onOpen,close:h.component.onClose,set:h.component.onSet}).on({start:l.onStart,render:l.onRender,stop:l.onStop,open:l.onOpen,close:l.onClose,set:l.onSet}),n=h.$holder[0],t="position",n.currentStyle?e=n.currentStyle[t]:window.getComputedStyle&&(e=getComputedStyle(n)[t]),c="fixed"==e,i.autofocus&&h.open(),h.trigger("start").trigger("render"));var e,t,n},render:function(e){return e?(h.$holder=m(a()),d(),h.$root.html(h.$holder)):h.$root.find("."+f.box).html(h.component.nodes(u.open)),h.trigger("render")},stop:function(){return u.start&&(h.close(),h._hidden&&h._hidden.parentNode.removeChild(h._hidden),h.$root.remove(),p.removeClass(f.input).removeData(o),setTimeout(function(){p.off("."+u.id)},0),i.type=u.type,i.readOnly=!1,h.trigger("stop"),u.methods={},u.start=!1),h},open:function(e){return u.open?h:(p.addClass(f.active),y(i,"expanded",!0),setTimeout(function(){h.$root.addClass(f.opened),y(h.$root[0],"hidden",!1)},0),!1!==e&&(u.open=!0,c&&m("body").css("overflow","hidden").css("padding-right","+="+n()),c&&b?h.$holder.find("."+f.frame).one("transitionend",function(){h.$holder.eq(0).focus()}):setTimeout(function(){h.$holder.eq(0).focus()},0),$.on("click."+u.id+" focusin."+u.id,function(e){var t;u.handlingOpen||(t=v(e,i),e.isSimulated)||t==i||t==document||3==e.which||h.close(t===h.$holder[0])}).on("keydown."+u.id,function(e){var t=e.keyCode,n=h.component.key[t],o=v(e,i);27==t?h.close(!0):o!=h.$holder[0]||!n&&13!=t?m.contains(h.$root[0],o)&&13==t&&(e.preventDefault(),o.click()):(e.preventDefault(),n?g._.trigger(h.component.key.go,h,[g._.trigger(n)]):h.$root.find("."+f.highlighted).hasClass(f.disabled)||(h.set("select",h.component.item.highlight),l.closeOnSelect&&h.close(!0)))})),h.trigger("open"))},close:function(e){return e&&(l.editable?i.focus():(h.$holder.off("focus.toOpen").focus(),setTimeout(function(){h.$holder.on("focus.toOpen",t)},0))),p.removeClass(f.active),y(i,"expanded",!1),setTimeout(function(){h.$root.removeClass(f.opened+" "+f.focused),y(h.$root[0],"hidden",!0)},0),u.open?(u.open=!1,c&&m("body").css("overflow","").css("padding-right","-="+n()),$.off("."+u.id),h.trigger("close")):h},clear:function(e){return h.set("clear",null,e)},set:function(e,t,n){var o,i,r=m.isPlainObject(e),a=r?e:{};if(n=r&&m.isPlainObject(t)?t:n||{},e){for(o in r||(a[e]=t),a)i=a[o],o in h.component.item&&(void 0===i&&(i=null),h.component.set(o,i,n)),"select"!=o&&"clear"!=o||!l.updateInput||p.val("clear"==o?"":h.get(o,l.format)).trigger("change");h.render()}return n.muted?h:h.trigger("set",a)},get:function(e,t){if(null!=u[e=e||"value"])return u[e];if("valueSubmit"==e){if(h._hidden)return h._hidden.value;e="value"}var n;return"value"==e?i.value:e in h.component.item?"string"==typeof t?(n=h.component.get(e))?g._.trigger(h.component.formats.toString,h.component,[t,n]):"":h.component.get(e):void 0},on:function(e,t,n){var o,i,r=m.isPlainObject(e),a=r?e:{};if(e)for(o in r||(a[e]=t),a)i=a[o],n&&(o="_"+o),u.methods[o]=u.methods[o]||[],u.methods[o].push(i);return h},off:function(){var e,t=arguments,n=0;for(namesCount=t.length;n<namesCount;n+=1)(e=t[n])in u.methods&&delete u.methods[e];return h},trigger:function(e,t){function n(e){(e=u.methods[e])&&e.map(function(e){g._.trigger(e,h,[t])})}return n("_"+e),n(e),h}},new e):g}function n(){if(r.height()<=o.height())return 0;var e=m('<div style="visibility:hidden;width:100px" />').appendTo("body"),t=e[0].offsetWidth;e.css("overflow","scroll");var n=m('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),t-n}function v(e,t){var n=[];return e.path&&(n=e.path),(n=e.originalEvent&&e.originalEvent.path?e.originalEvent.path:n)&&0<n.length?t&&0<=n.indexOf(t)?t:n[0]:e.target}function y(e,t,n){if(m.isPlainObject(t))for(var o in t)i(e,o,t[o]);else i(e,t,n)}function i(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function _(){try{return document.activeElement}catch(e){}}var o=m(window),$=m(document),r=m(document.documentElement),b=null!=document.documentElement.style.transition;return g.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},g._={group:function(e){for(var t,n="",o=g._.trigger(e.min,e);o<=g._.trigger(e.max,e,[o]);o+=e.i)t=g._.trigger(e.item,e,[o]),n+=g._.node(e.node,t[0],t[1],t[2]);return n},node:function(e,t,n,o){return t?"<"+e+(n=n?' class="'+n+'"':"")+(o=o?" "+o:"")+">"+(t=m.isArray(t)?t.join(""):t)+"</"+e+">":""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return-1<{}.toString.call(e).indexOf("Date")&&this.isInteger(e.getDate())},isInteger:function(e){return-1<{}.toString.call(e).indexOf("Number")&&e%1==0},ariaAttr:function(e,t){for(var n in m.isPlainObject(e)||(e={attribute:t}),t="",e)t+=null==e[n]?"":("role"==n?"":"aria-")+n+'="'+e[n]+'"';return t}},g.extend=function(o,i){m.fn[o]=function(e,t){var n=this.data(o);return"picker"==e?n:n&&"string"==typeof e?g._.trigger(n[e],n,[t]):this.each(function(){m(this).data(o)||new g(this,o,i,e)})},m.fn[o].defaults=i.defaults},g});